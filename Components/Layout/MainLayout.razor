<<<<<<< HEAD
<!--/* In the name of God, the Merciful, the Compassionate */-->`r`n@using Microsoft.AspNetCore.Components.Routing
=======
<!--/* In the name of God, the Merciful, the Compassionate */-->
@using Microsoft.AspNetCore.Components.Routing
>>>>>>> origin/master
@using Microsoft.AspNetCore.Components.Web
@using SqlHealthAssessment.Components.Shared

<div class="app-container" tabindex="0" @onkeydown="HandleKeyDown">
    <ToastContainer />
    <ShortcutsDialog IsVisible="@showShortcuts" OnClose="@(() => showShortcuts = false)" />
    <Router AppAssembly="@typeof(MainLayout).Assembly">
    <Found Context="routeData">
        <div class="app-layout">
            <NavMenu />
            <div class="app-content">
                <ErrorBoundary>
                    <RouteView RouteData="@routeData" />
                </ErrorBoundary>
            </div>
        </div>
    </Found>
    <NotFound>
        <div class="app-layout">
            <NavMenu />
            <div class="app-content">
                <div class="not-found">
                    <h2>Page not found</h2>
                    <p>The page you're looking for doesn't exist.</p>
                </div>
            </div>
        </div>
    </NotFound>
</Router>
</div>

@code {
    [Inject] private NavigationManager Navigation { get; set; } = null!;
    private bool showShortcuts = false;

    private void HandleKeyDown(KeyboardEventArgs args)
    {
        // ? for shortcuts help
        if (args.Key == "?" && !args.CtrlKey && !args.AltKey)
        {
            showShortcuts = !showShortcuts;
            return;
        }

        // Esc to close dialogs
        if (args.Key == "Escape")
        {
            showShortcuts = false;
            return;
        }

        // Ctrl+1-9 for quick navigation
        if (args.CtrlKey)
        {
            var key = args.Key;
            string? route = key switch
            {
                "1" => "/",
                "2" => "/instance",
                "3" => "/checks",
                "4" => "/fullaudit",
                "5" => "/health",
                "6" => "/settings",
                "7" => "/dashboard-editor",
                "8" => "/servers",
                "9" => "/bulkeditchecks",
                "h" or "H" => "/health",
                "q" or "Q" => "/checks",
                "e" or "E" => "/dashboard-editor",
                _ => null
            };
            
            if (route != null)
            {
                Navigation.NavigateTo(route);
            }
        }
    }
}
