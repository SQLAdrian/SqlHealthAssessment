<!--/* In the name of God, the Merciful, the Compassionate */-->
@using SqlHealthAssessment.Data.Models

<div class="session-legend">
    <div class="session-legend-header">
        <strong>Legend</strong>
        <button class="session-legend-close" @onclick="Close" title="Close">âœ•</button>
    </div>

    <div class="session-legend-body">
        <div class="legend-section">
            <h5>Connection</h5>
            <div class="session-legend-item">
                <svg width="40" height="30" viewBox="0 0 40 30">
                    <circle cx="15" cy="15" r="12" fill="#2196f3" opacity="0.8" />
                    <text x="15" y="19" text-anchor="middle" fill="white" font-size="9" font-weight="bold">76</text>
                    <line x1="27" y1="15" x2="38" y2="15" stroke="#888" stroke-width="1" />
                </svg>
                <span>76 - spid</span>
            </div>
        </div>

        <div class="legend-section">
            <h5>Size</h5>
            <div class="session-legend-item">
                <svg width="50" height="30" viewBox="0 0 50 30">
                    <circle cx="12" cy="15" r="8" fill="#2196f3" opacity="0.6" />
                    <circle cx="35" cy="15" r="14" fill="#2196f3" opacity="0.8" />
                </svg>
                <span>Connection activity</span>
            </div>
        </div>

        <div class="legend-section">
            <h5>Color</h5>
            <div class="session-legend-item">
                <svg width="80" height="30" viewBox="0 0 80 30">
                    <circle cx="12" cy="15" r="10" fill="#2196f3" opacity="0.8" />
                    <circle cx="38" cy="15" r="10" fill="#f44336" opacity="0.8" />
                    <circle cx="64" cy="15" r="10" fill="#4caf50" opacity="0.5" />
                </svg>
                <div class="legend-color-labels">
                    <span>Active</span>
                    <span>Blocked</span>
                    <span>Idle</span>
                </div>
            </div>
            <div class="legend-note">
                Blocked processes are displayed in red.<br />
                Red lines represent lock waits.
            </div>
        </div>

        <div class="legend-section">
            <h5>Border</h5>
            <div class="session-legend-item">
                <svg width="90" height="36" viewBox="0 0 90 36">
                    <circle cx="15" cy="18" r="12" fill="#2196f3" opacity="0.6" stroke="none" />
                    <text x="15" y="14" text-anchor="middle" fill="white" font-size="7">No</text>
                    <text x="15" y="22" text-anchor="middle" fill="white" font-size="7">txn</text>

                    <circle cx="45" cy="18" r="12" fill="#2196f3" opacity="0.7" stroke="#ffd700" stroke-width="2" />
                    <text x="45" y="14" text-anchor="middle" fill="white" font-size="7">In</text>
                    <text x="45" y="22" text-anchor="middle" fill="white" font-size="7">txn</text>

                    <circle cx="75" cy="18" r="12" fill="#f44336" opacity="0.8" stroke="#ff0000" stroke-width="4" />
                    <text x="75" y="14" text-anchor="middle" fill="white" font-size="6">Idle</text>
                    <text x="75" y="22" text-anchor="middle" fill="white" font-size="6">txn!</text>
                </svg>
            </div>
            <div class="legend-note">
                Gold border = open transaction.<br />
                <strong style="color: #f44336;">Thick red border</strong> = idle in transaction (dangerous).
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter] public EventCallback OnClose { get; set; }

    private async Task Close()
    {
        await OnClose.InvokeAsync();
    }
}
